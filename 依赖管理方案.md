# CNMoney 插件依赖管理方案

## 概述

CNMoney 插件现在提供两种依赖管理方案：

1. **在线依赖方案**（推荐）- 使用Maven仓库自动下载依赖
2. **本地依赖方案**（备用）- 使用本地JAR文件作为依赖

## 方案1：在线依赖（推荐）

### 特点
- ✅ 自动依赖管理
- ✅ 版本更新简单
- ✅ 标准Maven配置
- ❌ 需要网络连接

### 使用方法
```bash
# 直接编译，Maven会自动下载依赖
mvn clean package

# 或使用现有的编译脚本
编译.bat
```

### 配置文件
- 使用：`pom.xml`
- 仓库：JitPack, PlaceholderAPI官方仓库, Maven Central

## 方案2：本地依赖（备用）

### 特点
- ✅ 离线编译支持
- ✅ 依赖版本锁定
- ✅ 不依赖外部网络
- ❌ 需要手动管理JAR文件

### 设置步骤

#### 步骤1：下载依赖文件
```bash
# 自动下载（推荐）
下载依赖.bat

# 或手动下载到 lib/ 目录：
# - VaultAPI-1.7.1.jar
# - PlaceholderAPI-2.11.6.jar
```

#### 步骤2：使用本地编译
```bash
# 使用本地依赖编译
编译-本地依赖.bat

# 或手动执行
mvn -f pom-local.xml clean package
```

### 配置文件
- 使用：`pom-local.xml`
- 依赖：`lib/` 目录中的JAR文件

## 文件说明

### 编译相关文件
- `pom.xml` - 在线依赖配置（主配置）
- `pom-local.xml` - 本地依赖配置（备用配置）
- `编译.bat` - 在线编译脚本
- `编译-本地依赖.bat` - 本地依赖编译脚本

### 依赖管理文件
- `下载依赖.bat` - 自动下载依赖JAR文件
- `lib/` - 本地依赖存储目录
- `本地依赖说明.md` - 详细的本地依赖配置说明
- `依赖管理方案.md` - 本文档

## 推荐使用流程

### 日常开发（推荐）
```bash
# 1. 直接编译（自动下载依赖）
编译.bat

# 2. 如果网络有问题，切换到本地依赖
下载依赖.bat
编译-本地依赖.bat
```

### 离线环境
```bash
# 1. 在有网络的环境下载依赖
下载依赖.bat

# 2. 在离线环境使用本地依赖编译
编译-本地依赖.bat
```

## 依赖信息

### VaultAPI 1.7.1
- **用途**: 经济系统API接口
- **来源**: https://github.com/MilkBowl/VaultAPI
- **Maven坐标**: `com.github.MilkBowl:VaultAPI:1.7`

### PlaceholderAPI 2.11.6
- **用途**: 占位符系统API
- **来源**: https://github.com/PlaceholderAPI/PlaceholderAPI
- **Maven坐标**: `me.clip:placeholderapi:2.11.6`

## 故障排除

### 在线编译失败
1. 检查网络连接
2. 尝试使用本地依赖方案
3. 检查Maven配置

### 本地编译失败
1. 确保 `lib/` 目录存在
2. 确保JAR文件下载完整
3. 重新运行 `下载依赖.bat`

### 依赖下载失败
1. 检查网络连接和防火墙
2. 手动下载JAR文件到 `lib/` 目录
3. 使用浏览器下载后复制到项目

## 版本更新

### 更新在线依赖
1. 修改 `pom.xml` 中的版本号
2. 重新编译

### 更新本地依赖
1. 下载新版本JAR文件
2. 替换 `lib/` 目录中的文件
3. 更新 `pom-local.xml` 中的版本号和文件路径

## 总结

- **开发环境**：优先使用在线依赖方案（`pom.xml` + `编译.bat`）
- **生产环境**：可以使用本地依赖方案确保稳定性
- **离线环境**：必须使用本地依赖方案
- **CI/CD**：推荐使用在线依赖方案，但可以缓存依赖文件

这样的双重方案设计确保了在各种环境下都能成功编译CNMoney插件！
